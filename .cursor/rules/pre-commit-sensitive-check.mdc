---
description: 提交代码前检查敏感信息，避免泄露到公网 git。执行 git commit、git push 或用户表示要提交/推送时参考此规则。
alwaysApply: true
---

# 提交前敏感信息检查

在协助用户执行 **git commit**、**git push** 或用户明确表示要「提交」「推送」到公网 git 之前，必须先执行敏感信息检查。

## 检查时机

- 用户要求「提交」「commit」「push」「推送到远程」时
- 执行 `git commit` 或 `git push` 命令之前

## 敏感信息范围

以下内容不得出现在将要提交到公网仓库的文件中：

| 类型 | 示例 / 说明 |
|------|-------------|
| 环境变量与密钥 | `.env` 文件、`*.pem`、`*.key`、私钥、证书 |
| API / 访问密钥 | `API_KEY`、`SECRET`、`TOKEN`、`password`、`Bearer xxx` |
| 数据库连接串 | 含密码的 `DATABASE_URL`、`redis://user:pass@host` |
| 云服务凭证 | AWS/阿里云/腾讯云 AccessKey、SecretKey |
| 内网/敏感地址 | 内部 IP、未脱敏的域名、生产环境 URL |
| **客户/内部信息（名称与身份）** | 客户姓名、公司全称、客户邮箱/电话；内部项目名、内部系统名、团队/部门名、内部域名、内部邮箱、员工姓名、未脱敏的客户标识（ID/昵称） |

## 检查步骤

1. **查看暂存区**：执行 `git status` 和 `git diff --staged`，确认将要提交的文件与内容。
2. **核对 .gitignore**：确认 `.env`、`*.pem`、`*.key`、`/logs/` 等已在 `.gitignore` 中，且未被误加入暂存。
3. **扫描暂存内容**：在 `git diff --staged` 输出中搜索：
   - 文件名：`.env`、`*.pem`、`*.key`、`*secret*`、`*credentials*`
   - 内容模式：`password=`、`api_key=`、`secret=`、`Bearer `、私钥块（`-----BEGIN.*KEY-----`）
   - **名称/身份相关**：真实客户/公司名、内部项目/系统/团队名、内部域名（如 `*.internal`、`*.corp`）、真实邮箱/手机、未脱敏的客户 ID 或昵称；截图/文档中的联系人、组织架构等
4. **若发现敏感信息**：
   - 立即告知用户，**不要执行 commit/push**
   - 建议：从暂存移除（`git restore --staged <file>`）、将文件加入 `.gitignore`、用环境变量或 `.env.example` 占位

## 正确做法示例

- ✅ 提交 `.env.example`（占位、无真实密钥），不提交 `.env`
- ✅ 私钥、证书仅放在本地或安全存储，并在 `.gitignore` 中忽略
- ✅ 代码中通过环境变量读取密钥，不硬编码
- ✅ 示例/占位用通用名称（如「示例公司」「客户 A」「user@example.com」），不写真实客户名、内部项目名、内部邮箱

## 与本仓库相关

- 本仓库 `.gitignore` 已包含：`/.env`、`/product.pem`、`/logs/`
- 提交前务必确认上述路径未被 `git add` 进暂存区。
